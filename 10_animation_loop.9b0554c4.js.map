{"version":3,"sources":["src/10_animation_loop.coffee"],"names":[],"mappings":";CAAkD,WAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAClD,EAAK,OAAO,GACZ,EAAM,EAAG,IACT,EAAQ,EAAG,MAAM,IACT,EAAG,MAAM,IACjB,EAAQ,EAAG,MAAM,IACjB,EAAa,EAAG,WAAW,IAC3B,EAAQ,SAAS,eAAe,SAEhC,EAAU,WACR,EAAG,QACA,EAAG,MAAQ,GACZ,EAAG,IAAI,OACT,IACA,sBAAsB,IAGxB,EAAc,WACd,IAAA,EAAA,EAAA,EAAA,EAAA,EACE,IAAA,KADA,EAAI,EACJ,EAAA,UAAA,SACE,IAAA,KAAA,EAAA,UAAA,SAAA,GAEE,GADA,EAAQ,EAAG,UAAU,SAAS,GAAO,GAClC,MAAM,QAAQ,GACf,IAAA,KAAA,EACE,EAAI,SAAS,EAAQ,IAAM,EAAG,EAAM,GAAG,GAAI,EAAM,GAAG,GAAI,EAAM,GAAG,GAAI,GACrE,KAGV,EAAO,WACP,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAUE,IAAA,KAJA,EAAU,EAAM,uBAAuB,UACvC,EAAU,GACV,EAAO,EAEP,EAAA,IACE,IAAA,KAAA,EAAA,IAAA,GAEE,GAAkB,KADlB,EAAO,EAAG,IAAI,GAAK,IACX,OAAR,CAKE,IAJA,EAAO,EACS,UAAb,EAAK,OACN,EAAM,UAAY,eAAiB,EAAK,OAC1C,EAAI,EACE,EAAI,EAAQ,QAEP,EAAQ,GAAG,KACP,IACX,EAAiB,EAAG,IAAI,GAAK,GAAK,OAElC,EAAc,EAAI,qBAAqB,EAAgB,EAAG,UAAU,YAEpE,EAAQ,KAAK,GAEb,EAAQ,GAAG,MAAM,GAAK,EAAK,EAE3B,EAAQ,GAAG,MAAM,GAAK,EAAK,EAE3B,EAAQ,GAAG,MAAM,MAAQ,EAAK,EAG9B,EAAQ,GAAG,MAAM,OAAS,EAAK,OAC/B,EAAI,KAAK,EAAQ,IAEjB,EAAI,QAAQ,EAAQ,GAAI,EAAI,WAAW,EAAK,OAAQ,EAAK,UAAW,GAEpE,EAAO,GACT,IACS,IAAR,IAED,EAAM,EAAI,QAAQ,EAAK,EAAK,EAAG,EAAK,GAEpC,EAAQ,KAAK,QAEK,IAAf,EAAK,SAEN,QAAQ,IAAI,EAAK,KAAO,kCACxB,EAAI,MAAM,MAAQ,EAClB,EAAI,MAAM,OAAS,GACrB,KAGR,IAFA,EAAO,EACP,EAAI,EACE,EAAI,EAAQ,QAAlB,CACE,IAAA,KAAA,EAAA,IACE,IAAA,KAAA,EAAA,IAAA,GAEoB,KADlB,EAAO,EAAG,IAAI,GAAK,IACX,QAAgB,EAAQ,GAAG,KAAM,IACvC,EAAO,EAAQ,IACrB,IACS,IAAR,IACD,QAAQ,IAAI,iCAAmC,EAAK,IACpD,EAAI,WAAW,IAEjB,EAAM,MAAM,KAAO,KAAK,OAAO,EAAG,MAAQ,KAC1C,EAAM,MAAM,IAAM,KAAK,OAAO,EAAG,MAAQ,KACzC,EAAW,MAAM,mBAAqB,KAAK,OAAO,EAAG,MAAQ,MAAQ,KAAK,OAAO,EAAG,MAAQ,MAG9F,EAAG,MAAQ,EACX,MAAM,sqBAWN,IAGI,OAAO,wBACT,OAAO,sBACL,OAAO,6BAA+B,OAAO,0BAA4B,OAAO,wBAA0B,OAAO,yBAA2B,SAAC,EAAU,GACrJ,OAAO,WAAW,EAAU,IAAO,EAAG,OAE5C,KAEA,EAAe,IAAI,MAAM,aACZ,MAAO,EACpB,EAAa,SA7HqC,KAAA","file":"10_animation_loop.9b0554c4.js","sourceRoot":"..","sourcesContent":["# global namespace isn't working with CodeSandbox.\ngm = window.gm\nfnc = gm.fnc\nvport = gm.vport.dom\nlevel = gm.level.dom\ntiles = gm.tiles.dom\nbackground = gm.background.dom\nstats = document.getElementById('stats')\n\nanimate = ->\n  gm.ticks++\n  if gm.ticks > 2\n    gm.fnc.loop()\n  draw()\n  requestAnimationFrame animate\n  return\n\ncreateTiles = ->\n  i = 0\n  for sheet of gm.sheetData.tileData\n    for tile of gm.sheetData.tileData[sheet]\n      array = gm.sheetData.tileData[sheet][tile]\n      if Array.isArray(array)\n        for j of array\n          fnc.tileInst sheet + '_' + i, array[j][1], array[j][2], array[j][0], sheet\n          i++\n  return\n\ndraw = ->\n  #    loops thru the list of active object instances,\n  #    checks if the assigned sprite exists,\n  #    if it does not, create it.\n  #    if it does, move it, and angle it.\n  #    finally, remove any sprites not assigned to an\n  #    instance.\n  sprites = vport.getElementsByClassName('sprite')\n  sprList = []\n  flag = 0\n  # sprites\n  for obj of gm.ins\n    for ins of gm.ins[obj]\n      inst = gm.ins[obj][ins]\n      if inst.active == 1\n        flag = 0\n        if inst.name == 'chara'\n          stats.innerHTML = 'bones left: ' + inst.bones\n        l = 0\n        while l < sprites.length\n          # for each sprite\n          sprite = sprites[l].id\n          if sprite == ins\n            instanceSprite = gm.ins[obj][ins].sprite\n            # console.log(instanceSprite);\n            spriteSheet = fnc.searchForSpriteSheet(instanceSprite, gm.sheetData.spriteData)\n            # if matching sprite found\n            sprList.push ins\n            # add to list\n            sprites[l].style.xx = inst.x\n            # move the sprite X\n            sprites[l].style.yy = inst.y\n            # move the sprite Y\n            sprites[l].style.angle = inst.a\n            # rotate the sprite\n            #console.log(inst.sprite);\n            sprites[l].style.sprite = inst.sprite\n            fnc.repo sprites[l]\n            # move the sprite\n            fnc.chFrame sprites[l], fnc.parseFrame(inst.sprite, inst.subframe), spriteSheet\n            # & subframe\n            flag = 1\n          l++\n        if flag == 0\n          # no sprite found\n          spr = fnc.sprInst(ins, inst.x, inst.y)\n          # create sprite\n          sprList.push ins\n          # add to list\n          if inst.sprite == undefined\n            # no sprite defined\n            console.log inst.name + ' has no sprite assigned to it!'\n            spr.style.width = 0\n            spr.style.height = 0\n          draw()\n  flag = 0\n  i = 0\n  while i < sprites.length\n    for obj of gm.ins\n      for ins of gm.ins[obj]\n        inst = gm.ins[obj][ins]\n        if inst.active == 0 and sprites[i].id == ins\n          flag = sprites[i]\n    i++\n  if flag != 0\n    console.log 'sprite unassigned! Removing...' + flag.id\n    fnc.destroySpr flag\n  # tiles\n  tiles.style.left = Math.round(-gm.offX) + 'px'\n  tiles.style.top = Math.round(-gm.offY) + 'px'\n  background.style.backgroundPosition = Math.round(-gm.offX) + 'px ' + Math.round(-gm.offY) + 'px'\n  return\n\ngm.ticks = 0\nalert('THE SKIPPY GAME \\n \nSkippy is running around the park! But she misses her couch. \nShe needs to get back to the apartment before the sun leaves her favorite spot. \\n \nThe only problem is... there are squirrels in the park! The sheer AUDACITY! They are taunting Skippy with their reckless\nrunning. Skippy can resist the squirells up to a point... but when she gets too close she\nis pulled towards them. Luckily, she brought some bones with her to chew on, which makes her temporarily\nzen enough to peacefully coexist... for a time... \\n\nCONTROLS: \\n\nMove with the arrow keys \\n\nPress enter to chew on a bone and enter a brief zen state \\n\nGood Luck! \\n \\n \\n P.S: Happy Birthday!')\nanimate()\n# ensure that we have requestAnimationFrame\n# this is Paul Irish's compatibility shim\nif !window.requestAnimationFrame\n  window.requestAnimationFrame = do ->\n    window.webkitRequestAnimationFrame or window.mozRequestAnimationFrame or window.oRequestAnimationFrame or window.msRequestAnimationFrame or (callback, element) ->\n      window.setTimeout callback, 1000 / gm.fps\n      return\ncreateTiles()\n\naudioElement = new Audio(\"skip.wav\")\naudioElement.loop = true\naudioElement.play()\n\n# ---\n# generated by js2coffee 2.2.0"]}